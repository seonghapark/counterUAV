Jupyter Notebook
RNN-Model-wav
Last Checkpoint: 어제 오전 11:20
(unsaved changes)
Current Kernel Logo
Python 3 
File
Edit
View
Insert
Cell
Kernel
Help

1
import glob
2
import os
3
import random
4
import librosa
5
import matplotlib.pyplot as plt
6
import tensorflow as tf
7
from tensorflow.python.ops import rnn, rnn_cell
8
import numpy as np
9
%matplotlib inline
10
plt.style.use('ggplot')
123123
1
def windows(data, window_size):
2
    start = 0
3
    while start < len(data):
4
        yield start, start + window_size
5
        start += (window_size / 2)
6
?
7
# 각 33개 input, 각 6개 label
8
        
9
def extract_features(file_path, file_label, file_ext="*.wav",bands = 20, frames = 41):
10
    window_size = 512 * (frames - 1)
11
    mfccs = []
12
    labels = []
13
    sound_clip, s = librosa.load(file_path)
14
    #print(type(sound_clip))
15
    if file_label=='other':
16
        label_code = 0
17
    elif file_label=='person':
18
        label_code = 0
19
    elif file_label=='car':
20
        label_code = 1
21
    elif file_label=='drone':
22
        label_code = 123123
23
        
24
        
25
    #print(file_label, label_code)
26
    for (start,end) in windows(sound_clip,window_size):
27
        start = int(start)
28
        end = int(end)
29
        if(len(sound_clip[start:end]) == window_size):
30
            signal = sound_clip[start:end]
31
            mfcc = librosa.feature.mfcc(y=signal, sr=s, n_mfcc = bands).T.flatten()[:, np.newaxis].T
32
            mfccs.append(mfcc)
33
            labels.append(label_code)         
34
    features = np.asarray(mfccs).reshape(len(mfccs),frames,bands)
35
    return np.array(features), np.array(labels,dtype = np.int)
36
?
37
def one_hot_encode(labels):
38
    n_labels = len(labels)
39
    n_unique_labels = len(np.unique(labels))
40
    one_hot_encode = np.zeros((n_labels,n_unique_labels))
41
    one_hot_encode[np.arange(n_labels), labels] = 1
42
    return one_hot_encode
person
1
wav_file_path_training = 'C://slice_wav_data/training/'
2
file_list_training = os.listdir(wav_file_path_training)
3
?
4
tr_features = []
5
tr_labels = []
6
for f in file_list_training:
7
    file_label = f.split("_")[0]
8
    if file_label=='other' or file_label=='drone': ## 2개씩만 하는 코드
9
        continue
10
    features_temp, labels_temp = extract_features(wav_file_path_training + f, file_label)
11
    for tr_f in features_temp:
12
        tr_features.append(tr_f)
13
    for tr_l in labels_temp:
14
        tr_labels.append(tr_l)
15
    
16
?
17
tmp = [[x,y] for x,y in zip(tr_features, tr_labels)]
18
random.shuffle(tmp)
19
tr_features = [n[0] for n in tmp]
20
tr_labels = [n[1] for n in tmp]
21
?
22
?
23
wav_file_path_test = 'C://slice_wav_data/testing/'
24
file_list_test = os.listdir(wav_file_path_test)
25
?
26
ts_features = []
27
ts_labels = []
28
for f in file_list_test:
29
    file_label = f.split("_")[0]
30
    if file_label=='other' or file_label=='drone': ## 2개씩만 하는 코드
31
        continue
32
    features_temp, labels_temp = extract_features(wav_file_path_test + f, file_label)
33
    for ts_f in features_temp:
34
        ts_features.append(ts_f)
35
    for ts_l in labels_temp:
36
        ts_labels.append(ts_l)
37
    
38
tr_labels = one_hot_encode(tr_labels)
39
ts_labels = one_hot_encode(ts_labels)
40
?
41
tr_features = np.array(tr_features)
42
tr_labels = np.array(tr_labels)
43
?
44
ts_features = np.array(ts_features)
45
ts_labels = np.array(ts_labels)
temp_arr = np.array(tr_features)
temp_arr.shape
(594, 41, 20)
temp_arr = np.array(ts_labels) #mfcc를 통해 1188개 트레이닝 데이터, 216개 테스팅 데이터로 변환
temp_arr.shape
(108, 2)
tf.reset_default_graph()
?
learning_rate = 0.0006
training_iters = 20000
batch_size = 54 #1188과 216의 최대공약수는 54
display_step = 200
?
# Network Parameters
n_input = 20
n_steps = 41
n_hidden = 20
n_classes = 2
?
#앞에거는 hidden *2, 뒤에거는 n_input + n_hidden
?
x = tf.placeholder("float", [None, n_steps, n_input])
y = tf.placeholder("float", [None, n_classes])
?
weight = tf.Variable(tf.random_normal([n_hidden, n_classes]))
bias = tf.Variable(tf.random_normal([n_classes]))
WARNING:tensorflow:From C:\Users\kvlks\Miniconda3\lib\site-packages\tensorflow\python\framework\op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
def RNN(x, weight, bias):
    cell = rnn_cell.LSTMCell(n_hidden,state_is_tuple = True)
    cell = rnn_cell.MultiRNNCell([cell] * 8, state_is_tuple=True)
    output, state = tf.nn.dynamic_rnn(cell, x, dtype = tf.float32)
    print(1, output)
    output = tf.transpose(output, [1, 0, 2])
    print(1, output)
    last = tf.gather(output, int(output.get_shape()[0]) - 1)
    print(output.get_shape())
    print(1, last)
    return tf.nn.softmax(tf.matmul(last, weight) + bias)
prediction = RNN(x, weight, bias)
print(prediction)
?
# Define loss and optimizer
loss_f = -tf.reduce_sum(y * tf.log(prediction))
optimizer = tf.train.AdamOptimizer(learning_rate = learning_rate).minimize(loss_f)
?
# Evaluate model
correct_pred = tf.equal(tf.argmax(prediction,1), tf.argmax(y,1))
accuracy = tf.reduce_mean(tf.cast(correct_pred, tf.float32))
?
# Initializing the variables
init = tf.global_variables_initializer()
WARNING:tensorflow:From <ipython-input-7-1f170cd6f0b8>:2: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From <ipython-input-7-1f170cd6f0b8>:3: MultiRNNCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.StackedRNNCells, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:At least two cells provided to MultiRNNCell are the same object and will share weights.
WARNING:tensorflow:From <ipython-input-7-1f170cd6f0b8>:4: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
1 Tensor("rnn/transpose_1:0", shape=(?, 41, 20), dtype=float32)
1 Tensor("transpose:0", shape=(41, ?, 20), dtype=float32)
(41, ?, 20)
1 Tensor("GatherV2:0", shape=(?, 20), dtype=float32)
Tensor("Softmax:0", shape=(?, 2), dtype=float32)
WARNING:tensorflow:From C:\Users\kvlks\Miniconda3\lib\site-packages\tensorflow\python\ops\array_grad.py:425: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
C:\Users\kvlks\Miniconda3\lib\site-packages\tensorflow\python\ops\gradients_impl.py:110: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
with tf.Session() as session:
    session.run(init)
    
    training_epochs = 5000
    for epoch in range(training_epochs):
        avg_cost = 0
        total_batch = int(len(tr_features) / batch_size)
 
        for i in range(total_batch):
            start = ((i+1) * batch_size) - batch_size
            end = ((i+1) * batch_size)
            batch_x = tr_features[start:end]
            batch_y = tr_labels[start:end]
                
            _, c = session.run([optimizer, loss_f], feed_dict={x: batch_x, y : batch_y})
            avg_cost += c / total_batch
 
        print('Epoch:', '%04d' % (epoch + 1), 'cost =', '{:.9f}'.format(avg_cost), end='')
        print('Test accuracy: ',round(session.run(accuracy, feed_dict={x: ts_features, y: ts_labels}) , 3))
    print('Learning Finished!')
    saver = tf.train.Saver()
    saver.save(session, './cuav_rnn.ckpt')
    print('Graph Saved! ')
    
    '''
    for itr in range(training_iters):    
        offset = (itr * batch_size) % (tr_labels.shape[0] - batch_size)
        batch_x = tr_features[offset:offset + batch_size]
        batch_y = tr_labels[offset:offset + batch_size]
        _, c = session.run([optimizer, loss_f],feed_dict={x: batch_x, y : batch_y})
            
        #if epoch % display_step == 0:
        if itr % 100 == 0:
            # Calculate batch accuracy
            acc = session.run(accuracy, feed_dict={x: batch_x, y: batch_y})
            # Calculate batch loss
            loss = session.run(loss_f, feed_dict={x: batch_x, y: batch_y})
            print("Iter " + str(itr) + ", Minibatch Loss= " + 
                  "{:.6f}".format(loss) + ", Training Accuracy= " + 
                  "{:.5f}".format(acc))
    '''
Epoch: 0001 cost = 43.424834165Test accuracy:  0.5
Epoch: 0002 cost = 38.668060303Test accuracy:  0.5
Epoch: 0003 cost = 37.972760981Test accuracy:  0.528
Epoch: 0004 cost = 37.518444061Test accuracy:  0.528
Epoch: 0005 cost = 37.313172080Test accuracy:  0.5
Epoch: 0006 cost = 37.362078927Test accuracy:  0.5
Epoch: 0007 cost = 37.286461570Test accuracy:  0.5
Epoch: 0008 cost = 37.168032213Test accuracy:  0.5
Epoch: 0009 cost = 37.067186182Test accuracy:  0.5
Epoch: 0010 cost = 36.891726407Test accuracy:  0.5
Epoch: 0011 cost = 36.781113018Test accuracy:  0.5
Epoch: 0012 cost = 36.704013131Test accuracy:  0.5
Epoch: 0013 cost = 36.624837355Test accuracy:  0.5
Epoch: 0014 cost = 36.554497806Test accuracy:  0.5
Epoch: 0015 cost = 36.495136261Test accuracy:  0.5
Epoch: 0016 cost = 36.448566090Test accuracy:  0.5
Epoch: 0017 cost = 36.410202026Test accuracy:  0.5
Epoch: 0018 cost = 36.336735465Test accuracy:  0.5
Epoch: 0019 cost = 35.262114785Test accuracy:  0.704
Epoch: 0020 cost = 33.496266625Test accuracy:  0.657
Epoch: 0021 cost = 32.528476022Test accuracy:  0.667
Epoch: 0022 cost = 32.043192603Test accuracy:  0.667
Epoch: 0023 cost = 27.306021430Test accuracy:  0.648
Epoch: 0024 cost = 21.751844406Test accuracy:  0.639
Epoch: 0025 cost = 20.451594526Test accuracy:  0.63
Epoch: 0026 cost = 20.578262589Test accuracy:  0.667
Epoch: 0027 cost = 20.272014618Test accuracy:  0.694
Epoch: 0028 cost = 19.470707026Test accuracy:  0.639
Epoch: 0029 cost = 18.912596876Test accuracy:  0.694
Epoch: 0030 cost = 18.486330986Test accuracy:  0.667
Epoch: 0031 cost = 18.320710009Test accuracy:  0.694
Epoch: 0032 cost = 18.105333675Test accuracy:  0.704
Epoch: 0033 cost = 17.795317997Test accuracy:  0.694
Epoch: 0034 cost = 17.787360538Test accuracy:  0.713
Epoch: 0035 cost = 17.508840821Test accuracy:  0.704
Epoch: 0036 cost = 17.323919816Test accuracy:  0.722
Epoch: 0037 cost = 17.214238687Test accuracy:  0.741
Epoch: 0038 cost = 17.046792117Test accuracy:  0.759
Epoch: 0039 cost = 16.909417326Test accuracy:  0.75
Epoch: 0040 cost = 16.796251384Test accuracy:  0.759
Epoch: 0041 cost = 16.665989789Test accuracy:  0.759
Epoch: 0042 cost = 16.558798530Test accuracy:  0.759
Epoch: 0043 cost = 16.422966177Test accuracy:  0.759
Epoch: 0044 cost = 16.314309467Test accuracy:  0.759
Epoch: 0045 cost = 16.189152891Test accuracy:  0.759
Epoch: 0046 cost = 16.086640228Test accuracy:  0.769
Epoch: 0047 cost = 15.976207560Test accuracy:  0.769
Epoch: 0048 cost = 15.876003179Test accuracy:  0.769
Epoch: 0049 cost = 15.768520529Test accuracy:  0.759
Epoch: 0050 cost = 15.658313188Test accuracy:  0.759
Epoch: 0051 cost = 15.537171581Test accuracy:  0.759
Epoch: 0052 cost = 15.413088278Test accuracy:  0.75
Epoch: 0053 cost = 15.290014700Test accuracy:  0.75
Epoch: 0054 cost = 15.174324556Test accuracy:  0.75
Epoch: 0055 cost = 15.066538637Test accuracy:  0.759
Epoch: 0056 cost = 15.018781965Test accuracy:  0.759
Epoch: 0057 cost = 15.006157702Test accuracy:  0.759
Epoch: 0058 cost = 14.997109413Test accuracy:  0.759
Epoch: 0059 cost = 14.981410980Test accuracy:  0.769
Epoch: 0060 cost = 14.962521163Test accuracy:  0.759
Epoch: 0061 cost = 14.943167426Test accuracy:  0.759
Epoch: 0062 cost = 14.922907266Test accuracy:  0.759
Epoch: 0063 cost = 14.964232401Test accuracy:  0.759
Epoch: 0064 cost = 14.909924681Test accuracy:  0.759
Epoch: 0065 cost = 14.887828784Test accuracy:  0.769
Epoch: 0066 cost = 14.821326863Test accuracy:  0.759
Epoch: 0067 cost = 15.074464798Test accuracy:  0.759
Epoch: 0068 cost = 14.974443176Test accuracy:  0.759
Epoch: 0069 cost = 14.874046586Test accuracy:  0.75
Epoch: 0070 cost = 14.797314644Test accuracy:  0.759
Epoch: 0071 cost = 14.697171818Test accuracy:  0.75
Epoch: 0072 cost = 14.679499019Test accuracy:  0.759
Epoch: 0073 cost = 14.384974826Test accuracy:  0.759
Epoch: 0074 cost = 14.307532831Test accuracy:  0.759
Epoch: 0075 cost = 14.395317858Test accuracy:  0.759
Epoch: 0076 cost = 14.275220091Test accuracy:  0.759
Epoch: 0077 cost = 14.325672410Test accuracy:  0.759
Epoch: 0078 cost = 14.307857123Test accuracy:  0.759
Epoch: 0079 cost = 14.282526320Test accuracy:  0.759
Epoch: 0080 cost = 14.271836368Test accuracy:  0.759
Epoch: 0081 cost = 14.265245784Test accuracy:  0.759
Epoch: 0082 cost = 14.250718594Test accuracy:  0.759
Epoch: 0083 cost = 14.237395590Test accuracy:  0.759
Epoch: 0084 cost = 14.224146236Test accuracy:  0.759
Epoch: 0085 cost = 14.220476237Test accuracy:  0.759
Epoch: 0086 cost = 14.226585648Test accuracy:  0.759
Epoch: 0087 cost = 14.244297548Test accuracy:  0.75
Epoch: 0088 cost = 14.173310410Test accuracy:  0.759
Epoch: 0089 cost = 14.127946073Test accuracy:  0.759
Epoch: 0090 cost = 14.034620025Test accuracy:  0.759
Epoch: 0091 cost = 14.284722632Test accuracy:  0.759
Epoch: 0092 cost = 14.747218652Test accuracy:  0.759
Epoch: 0093 cost = 17.789670121Test accuracy:  0.722
Epoch: 0094 cost = 14.344743555Test accuracy:  0.75
Epoch: 0095 cost = 16.212060061Test accuracy:  0.759
Epoch: 0096 cost = 16.683578144Test accuracy:  0.713
Epoch: 0097 cost = 18.240490133Test accuracy:  0.722
Epoch: 0098 cost = 16.119432536Test accuracy:  0.75
Epoch: 0099 cost = 17.516583963Test accuracy:  0.713
Epoch: 0100 cost = 18.059413997Test accuracy:  0.722
Epoch: 0101 cost = 16.106618188Test accuracy:  0.731
Epoch: 0102 cost = 16.966689196Test accuracy:  0.722
Epoch: 0103 cost = 17.440541961Test accuracy:  0.731
Epoch: 0104 cost = 15.503256624Test accuracy:  0.731
Epoch: 0105 cost = 15.303400820Test accuracy:  0.722
Epoch: 0106 cost = 15.269423268Test accuracy:  0.731
Epoch: 0107 cost = 14.265843825Test accuracy:  0.75
Epoch: 0108 cost = 14.300403855Test accuracy:  0.741
Epoch: 0109 cost = 14.029086807Test accuracy:  0.741
Epoch: 0110 cost = 14.039284706Test accuracy:  0.75
Epoch: 0111 cost = 13.997568911Test accuracy:  0.75
Epoch: 0112 cost = 13.962271777Test accuracy:  0.741
Epoch: 0113 cost = 13.956978755Test accuracy:  0.75
Epoch: 0114 cost = 13.939320868Test accuracy:  0.741
Epoch: 0115 cost = 13.931103533Test accuracy:  0.741
Epoch: 0116 cost = 13.917919549Test accuracy:  0.741
Epoch: 0117 cost = 13.906247919Test accuracy:  0.741
Epoch: 0118 cost = 13.898498795Test accuracy:  0.741
Epoch: 0119 cost = 13.891878952Test accuracy:  0.741
Epoch: 0120 cost = 13.891448715Test accuracy:  0.741
Epoch: 0121 cost = 13.908171350Test accuracy:  0.741
Epoch: 0122 cost = 13.980139386Test accuracy:  0.741
Epoch: 0123 cost = 14.451155706Test accuracy:  0.722
Epoch: 0124 cost = 15.489459124Test accuracy:  0.741
Epoch: 0125 cost = 13.954236768Test accuracy:  0.741
Epoch: 0126 cost = 14.033874165Test accuracy:  0.741
Epoch: 0127 cost = 14.041739464Test accuracy:  0.741
Epoch: 0128 cost = 13.957979939Test accuracy:  0.741
Epoch: 0129 cost = 13.824355906Test accuracy:  0.731
Epoch: 0130 cost = 13.716440764Test accuracy:  0.741
Epoch: 0131 cost = 13.740912524Test accuracy:  0.741
Epoch: 0132 cost = 13.831943122Test accuracy:  0.75
Epoch: 0133 cost = 13.901518995Test accuracy:  0.741
Epoch: 0134 cost = 15.183076208Test accuracy:  0.741
Epoch: 0135 cost = 13.832687985Test accuracy:  0.759
Epoch: 0136 cost = 14.546895071Test accuracy:  0.731
Epoch: 0137 cost = 15.581828984Test accuracy:  0.75
Epoch: 0138 cost = 14.167599375Test accuracy:  0.731
Epoch: 0139 cost = 15.918289965Test accuracy:  0.759
Epoch: 0140 cost = 14.787463362Test accuracy:  0.731
Epoch: 0141 cost = 13.895066045Test accuracy:  0.731
Epoch: 0142 cost = 13.809039463Test accuracy:  0.741
Epoch: 0143 cost = 13.807476911Test accuracy:  0.731
Epoch: 0144 cost = 13.677070531Test accuracy:  0.75
Epoch: 0145 cost = 13.731834498Test accuracy:  0.741
Epoch: 0146 cost = 13.641984376Test accuracy:  0.741
Epoch: 0147 cost = 13.687164957Test accuracy:  0.75
Epoch: 0148 cost = 13.964293090Test accuracy:  0.75
Epoch: 0149 cost = 14.412273494Test accuracy:  0.759
Epoch: 0150 cost = 15.027489272Test accuracy:  0.741
Epoch: 0151 cost = 15.594772296Test accuracy:  0.731
Epoch: 0152 cost = 15.313296752Test accuracy:  0.741
Epoch: 0153 cost = 17.205232187Test accuracy:  0.731
Epoch: 0154 cost = 17.142443917Test accuracy:  0.722
Epoch: 0155 cost = 15.219906200Test accuracy:  0.741
Epoch: 0156 cost = 14.983126120Test accuracy:  0.741
Epoch: 0157 cost = 14.705309521Test accuracy:  0.741
Epoch: 0158 cost = 14.520946026Test accuracy:  0.75
Epoch: 0159 cost = 13.672996694Test accuracy:  0.731
Epoch: 0160 cost = 14.552835464Test accuracy:  0.741
Epoch: 0161 cost = 13.954357927Test accuracy:  0.75
Epoch: 0162 cost = 14.399221594Test accuracy:  0.741
Epoch: 0163 cost = 13.692503886Test accuracy:  0.75
Epoch: 0164 cost = 14.120631045Test accuracy:  0.741
Epoch: 0165 cost = 13.763077909Test accuracy:  0.741
Epoch: 0166 cost = 14.626583620Test accuracy:  0.75
Epoch: 0167 cost = 13.790879466Test accuracy:  0.731
Epoch: 0168 cost = 13.680073001Test accuracy:  0.75
Epoch: 0169 cost = 14.219241836Test accuracy:  0.75
Epoch: 0170 cost = 13.571336573Test accuracy:  0.75
Epoch: 0171 cost = 13.893897403Test accuracy:  0.75
Epoch: 0172 cost = 13.677564621Test accuracy:  0.75
Epoch: 0173 cost = 14.126589472Test accuracy:  0.741
Epoch: 0174 cost = 13.779586185Test accuracy:  0.731
Epoch: 0175 cost = 14.765867147Test accuracy:  0.75
Epoch: 0176 cost = 13.633468931Test accuracy:  0.75
Epoch: 0177 cost = 13.838614507Test accuracy:  0.759
Epoch: 0178 cost = 13.670151364Test accuracy:  0.75
Epoch: 0179 cost = 13.828804276Test accuracy:  0.759
Epoch: 0180 cost = 13.546942364Test accuracy:  0.75
Epoch: 0181 cost = 13.894030441Test accuracy:  0.741
Epoch: 0182 cost = 13.517158812Test accuracy:  0.75
Epoch: 0183 cost = 13.952295433Test accuracy:  0.75
Epoch: 0184 cost = 13.706518953Test accuracy:  0.741
Epoch: 0185 cost = 15.672972202Test accuracy:  0.741
Epoch: 0186 cost = 14.092705380Test accuracy:  0.731
Epoch: 0187 cost = 15.217786616Test accuracy:  0.75
Epoch: 0188 cost = 13.836717822Test accuracy:  0.731
Epoch: 0189 cost = 14.520400871Test accuracy:  0.741
Epoch: 0190 cost = 13.961474332Test accuracy:  0.75
Epoch: 0191 cost = 13.846849268Test accuracy:  0.75
Epoch: 0192 cost = 13.490332777Test accuracy:  0.731
Epoch: 0193 cost = 14.016933528Test accuracy:  0.75
Epoch: 0194 cost = 13.351267815Test accuracy:  0.75
Epoch: 0195 cost = 13.495574431Test accuracy:  0.759
Epoch: 0196 cost = 13.424932957Test accuracy:  0.75
Epoch: 0197 cost = 13.814061295Test accuracy:  0.741
Epoch: 0198 cost = 13.477273594Test accuracy:  0.75
Epoch: 0199 cost = 14.631005764Test accuracy:  0.75
Epoch: 0200 cost = 13.325931983Test accuracy:  0.75
Epoch: 0201 cost = 13.659103914Test accuracy:  0.759
Epoch: 0202 cost = 13.487486796Test accuracy:  0.75
Epoch: 0203 cost = 14.246777665Test accuracy:  0.75
Epoch: 0204 cost = 13.404335195Test accuracy:  0.75
Epoch: 0205 cost = 14.165398684Test accuracy:  0.75
Epoch: 0206 cost = 13.304922191Test accuracy:  0.731
Epoch: 0207 cost = 14.264937878Test accuracy:  0.75
Epoch: 0208 cost = 13.343440186Test accuracy:  0.731
Epoch: 0209 cost = 15.211536754Test accuracy:  0.722
Epoch: 0210 cost = 14.355240388Test accuracy:  0.741
Epoch: 0211 cost = 14.739551718Test accuracy:  0.759
Epoch: 0212 cost = 13.745521415Test accuracy:  0.731
Epoch: 0213 cost = 14.042281498Test accuracy:  0.741
Epoch: 0214 cost = 13.370951913Test accuracy:  0.75
Epoch: 0215 cost = 13.253012137Test accuracy:  0.75
Epoch: 0216 cost = 13.199397824Test accuracy:  0.75
Epoch: 0217 cost = 12.925450325Test accuracy:  0.75
Epoch: 0218 cost = 12.909728050Test accuracy:  0.75
Epoch: 0219 cost = 12.880597461Test accuracy:  0.75
Epoch: 0220 cost = 12.857302319Test accuracy:  0.75
Epoch: 0221 cost = 12.808186748Test accuracy:  0.75
Epoch: 0222 cost = 12.833646904Test accuracy:  0.75
Epoch: 0223 cost = 12.844150326Test accuracy:  0.75
Epoch: 0224 cost = 12.901105967Test accuracy:  0.75
Epoch: 0225 cost = 13.157782208Test accuracy:  0.75
Epoch: 0226 cost = 13.203088847Test accuracy:  0.75
Epoch: 0227 cost = 13.522136298Test accuracy:  0.75
Epoch: 0228 cost = 13.998783415Test accuracy:  0.741
Epoch: 0229 cost = 13.617352356Test accuracy:  0.75
Epoch: 0230 cost = 13.420749621Test accuracy:  0.75
Epoch: 0231 cost = 12.800783201Test accuracy:  0.75
Epoch: 0232 cost = 12.728094621Test accuracy:  0.75
Epoch: 0233 cost = 12.709787022Test accuracy:  0.75
Epoch: 0234 cost = 12.598336783Test accuracy:  0.75
Epoch: 0235 cost = 12.697134365Test accuracy:  0.75
Epoch: 0236 cost = 12.526555625Test accuracy:  0.75
Epoch: 0237 cost = 12.547956337Test accuracy:  0.75
Epoch: 0238 cost = 12.499972820Test accuracy:  0.75
Epoch: 0239 cost = 12.493445006Test accuracy:  0.75
Epoch: 0240 cost = 12.554522081Test accuracy:  0.75
Epoch: 0241 cost = 12.848612352Test accuracy:  0.731
Epoch: 0242 cost = 13.561684348Test accuracy:  0.75
Epoch: 0243 cost = 12.862292073Test accuracy:  0.75
Epoch: 0244 cost = 14.094695091Test accuracy:  0.741
Epoch: 0245 cost = 16.272888270Test accuracy:  0.741
Epoch: 0246 cost = 16.039128997Test accuracy:  0.759
Epoch: 0247 cost = 15.543877775Test accuracy:  0.741
Epoch: 0248 cost = 15.430576411Test accuracy:  0.731
Epoch: 0249 cost = 16.764247547Test accuracy:  0.759
Epoch: 0250 cost = 14.146915522Test accuracy:  0.741
Epoch: 0251 cost = 13.013679548Test accuracy:  0.75
Epoch: 0252 cost = 12.764085596Test accuracy:  0.741
Epoch: 0253 cost = 14.418782408Test accuracy:  0.731
Epoch: 0254 cost = 12.818572695Test accuracy:  0.741
Epoch: 0255 cost = 13.535629316Test accuracy:  0.75
Epoch: 0256 cost = 12.745531169Test accuracy:  0.741
Epoch: 0257 cost = 12.609565822Test accuracy:  0.75
Epoch: 0258 cost = 12.651056290Test accuracy:  0.741
Epoch: 0259 cost = 12.507227724Test accuracy:  0.75
Epoch: 0260 cost = 12.495397698Test accuracy:  0.741
Epoch: 0261 cost = 12.424006332Test accuracy:  0.75
Epoch: 0262 cost = 12.864330769Test accuracy:  0.741
Epoch: 0263 cost = 14.354160699Test accuracy:  0.759
Epoch: 0264 cost = 14.892780911Test accuracy:  0.741
Epoch: 0265 cost = 13.019261273Test accuracy:  0.741
Epoch: 0266 cost = 12.525665977Test accuracy:  0.741
Epoch: 0267 cost = 12.447997917Test accuracy:  0.75
Epoch: 0268 cost = 12.353089636Test accuracy:  0.741
Epoch: 0269 cost = 12.288607727Test accuracy:  0.75
Epoch: 0270 cost = 12.256202828Test accuracy:  0.75
Epoch: 0271 cost = 12.779424624Test accuracy:  0.741
Epoch: 0272 cost = 14.137907592Test accuracy:  0.769
Epoch: 0273 cost = 14.399479086Test accuracy:  0.741
Epoch: 0274 cost = 12.723141323Test accuracy:  0.741
Epoch: 0275 cost = 12.413384438Test accuracy:  0.741
Epoch: 0276 cost = 12.230450630Test accuracy:  0.75
Epoch: 0277 cost = 12.204222116Test accuracy:  0.741
Epoch: 0278 cost = 12.367626667Test accuracy:  0.741
Epoch: 0279 cost = 12.328716885Test accuracy:  0.75
Epoch: 0280 cost = 12.364428303Test accuracy:  0.731
Epoch: 0281 cost = 12.326479738Test accuracy:  0.75
Epoch: 0282 cost = 12.258223664Test accuracy:  0.75
Epoch: 0283 cost = 14.165513385Test accuracy:  0.731
Epoch: 0284 cost = 14.385853161Test accuracy:  0.731
Epoch: 0285 cost = 12.843271559Test accuracy:  0.759
Epoch: 0286 cost = 13.051792231Test accuracy:  0.731
Epoch: 0287 cost = 12.289566257Test accuracy:  0.741
Epoch: 0288 cost = 12.191589009Test accuracy:  0.741
Epoch: 0289 cost = 11.947885340Test accuracy:  0.741
Epoch: 0290 cost = 11.884446448Test accuracy:  0.741
Epoch: 0291 cost = 11.822051222Test accuracy:  0.75
Epoch: 0292 cost = 11.760502295Test accuracy:  0.741
Epoch: 0293 cost = 11.755222841Test accuracy:  0.741
Epoch: 0294 cost = 11.712351322Test accuracy:  0.741
Epoch: 0295 cost = 11.718237443Test accuracy:  0.741
Epoch: 0296 cost = 11.716581865Test accuracy:  0.741
Epoch: 0297 cost = 11.847823230Test accuracy:  0.741
Epoch: 0298 cost = 11.804885691Test accuracy:  0.75
Epoch: 0299 cost = 11.974692518Test accuracy:  0.741
Epoch: 0300 cost = 11.587884383Test accuracy:  0.75
Epoch: 0301 cost = 11.820916956Test accuracy:  0.741
Epoch: 0302 cost = 11.821057927Test accuracy:  0.75
Epoch: 0303 cost = 12.379953905Test accuracy:  0.741
Epoch: 0304 cost = 11.819936666Test accuracy:  0.778
Epoch: 0305 cost = 14.849276629Test accuracy:  0.741
Epoch: 0306 cost = 12.624984438Test accuracy:  0.769
Epoch: 0307 cost = 12.873493021Test accuracy:  0.741
Epoch: 0308 cost = 12.299251816Test accuracy:  0.75
Epoch: 0309 cost = 16.176373135Test accuracy:  0.722
Epoch: 0310 cost = 14.908492262Test accuracy:  0.694
Epoch: 0311 cost = 12.549024755Test accuracy:  0.741
Epoch: 0312 cost = 11.831993190Test accuracy:  0.769
Epoch: 0313 cost = 12.534708977Test accuracy:  0.741
Epoch: 0314 cost = 11.482804602Test accuracy:  0.759
Epoch: 0315 cost = 12.002583114Test accuracy:  0.75
Epoch: 0316 cost = 11.339833520Test accuracy:  0.731
Epoch: 0317 cost = 11.366316102Test accuracy:  0.759
Epoch: 0318 cost = 11.143432270Test accuracy:  0.741
Epoch: 0319 cost = 11.208719817Test accuracy:  0.75
Epoch: 0320 cost = 11.069652081Test accuracy:  0.75
Epoch: 0321 cost = 10.941459699Test accuracy:  0.75
Epoch: 0322 cost = 10.919762871Test accuracy:  0.75
Epoch: 0323 cost = 10.817325072Test accuracy:  0.75
Epoch: 0324 cost = 10.770624551Test accuracy:  0.75
Epoch: 0325 cost = 10.801910964Test accuracy:  0.75
Epoch: 0326 cost = 10.704066667Test accuracy:  0.778
Epoch: 0327 cost = 11.292463346Test accuracy:  0.75
Epoch: 0328 cost = 10.690210689Test accuracy:  0.769
Epoch: 0329 cost = 11.151096951Test accuracy:  0.75
Epoch: 0330 cost = 10.710195541Test accuracy:  0.787
Epoch: 0331 cost = 12.814217177Test accuracy:  0.722
Epoch: 0332 cost = 12.271209067Test accuracy:  0.75
Epoch: 0333 cost = 15.579157916Test accuracy:  0.667
Epoch: 0334 cost = 17.793692155Test accuracy:  0.657
Epoch: 0335 cost = 14.674567049Test accuracy:  0.75
Epoch: 0336 cost = 11.324087663Test accuracy:  0.741
Epoch: 0337 cost = 13.358613318Test accuracy:  0.741
Epoch: 0338 cost = 13.610142274Test accuracy:  0.759
Epoch: 0339 cost = 14.904544570Test accuracy:  0.75
Epoch: 0340 cost = 14.568881122Test accuracy:  0.787
Epoch: 0341 cost = 12.211552316Test accuracy:  0.704
Epoch: 0342 cost = 10.752023610Test accuracy:  0.75
Epoch: 0343 cost = 10.880668727Test accuracy:  0.731
Epoch: 0344 cost = 11.144346064Test accuracy:  0.741
Epoch: 0345 cost = 10.719185829Test accuracy:  0.704
Epoch: 0346 cost = 10.929288777Test accuracy:  0.741
Epoch: 0347 cost = 10.316009218Test accuracy:  0.722
Epoch: 0348 cost = 10.325294581Test accuracy:  0.731
Epoch: 0349 cost = 10.972824834Test accuracy:  0.75
Epoch: 0350 cost = 10.211196119Test accuracy:  0.731
Epoch: 0351 cost = 10.304491953Test accuracy:  0.731
Epoch: 0352 cost = 10.902136022Test accuracy:  0.769
Epoch: 0353 cost = 10.264766520Test accuracy:  0.731
Epoch: 0354 cost = 10.428043322Test accuracy:  0.722
Epoch: 0355 cost = 10.592761517Test accuracy:  0.75
Epoch: 0356 cost = 10.104542429Test accuracy:  0.731
Epoch: 0357 cost = 10.064533884Test accuracy:  0.722
Epoch: 0358 cost = 10.000570601Test accuracy:  0.731
Epoch: 0359 cost = 10.241403580Test accuracy:  0.713
Epoch: 0360 cost = 10.164430098Test accuracy:  0.759
Epoch: 0361 cost = 11.609736746Test accuracy:  0.796
Epoch: 0362 cost = 12.593506206Test accuracy:  0.639
Epoch: 0363 cost = 14.554899216Test accuracy:  0.731
Epoch: 0364 cost = 12.007051685Test accuracy:  0.676
Epoch: 0365 cost = 17.376738808Test accuracy:  0.565
Epoch: 0366 cost = 18.992518512Test accuracy:  0.602
Epoch: 0367 cost = 18.492544174Test accuracy:  0.593
Epoch: 0368 cost = 18.037487550Test accuracy:  0.583
Epoch: 0369 cost = 17.836913629Test accuracy:  0.593
Epoch: 0370 cost = 19.987342834Test accuracy:  0.611
Epoch: 0371 cost = 18.983945500Test accuracy:  0.602
Epoch: 0372 cost = 18.602269606Test accuracy:  0.611
Epoch: 0373 cost = 17.762345227Test accuracy:  0.611
Epoch: 0374 cost = 16.373242898Test accuracy:  0.63
Epoch: 0375 cost = 15.835669691Test accuracy:  0.639
Epoch: 0376 cost = 16.456508030Test accuracy:  0.676
Epoch: 0377 cost = 15.688764052Test accuracy:  0.704
Epoch: 0378 cost = 14.300764864Test accuracy:  0.657
Epoch: 0379 cost = 14.454618020Test accuracy:  0.685
Epoch: 0380 cost = 14.159169804Test accuracy:  0.704
Epoch: 0381 cost = 13.399448655Test accuracy:  0.685
Epoch: 0382 cost = 13.815964525Test accuracy:  0.75
Epoch: 0383 cost = 12.353790673Test accuracy:  0.694
Epoch: 0384 cost = 12.687829711Test accuracy:  0.75
Epoch: 0385 cost = 11.199009722Test accuracy:  0.704
Epoch: 0386 cost = 12.070697394Test accuracy:  0.759
Epoch: 0387 cost = 10.162575332Test accuracy:  0.694
Epoch: 0388 cost = 11.657807090Test accuracy:  0.759
Epoch: 0389 cost = 10.208796068Test accuracy:  0.713
Epoch: 0390 cost = 11.529844674Test accuracy:  0.759
Epoch: 0391 cost = 10.211705728Test accuracy:  0.713
Epoch: 0392 cost = 11.279233326Test accuracy:  0.759
Epoch: 0393 cost = 10.158179023Test accuracy:  0.694
Epoch: 0394 cost = 10.872466391Test accuracy:  0.759
Epoch: 0395 cost = 9.802198757Test accuracy:  0.713
Epoch: 0396 cost = 11.118819844Test accuracy:  0.759
Epoch: 0397 cost = 10.075722261Test accuracy:  0.704
Epoch: 0398 cost = 10.768596259Test accuracy:  0.778
Epoch: 0399 cost = 9.730772062Test accuracy:  0.704
Epoch: 0400 cost = 10.841713428Test accuracy:  0.759
Epoch: 0401 cost = 9.965467756Test accuracy:  0.694
Epoch: 0402 cost = 10.561584343Test accuracy:  0.769
Epoch: 0403 cost = 9.669697762Test accuracy:  0.713
Epoch: 0404 cost = 10.871953834Test accuracy:  0.769
Epoch: 0405 cost = 9.959257776Test accuracy:  0.685
Epoch: 0406 cost = 10.527414972Test accuracy:  0.778
Epoch: 0407 cost = 9.638230107Test accuracy:  0.713
Epoch: 0408 cost = 10.756033551Test accuracy:  0.778
Epoch: 0409 cost = 9.849256732Test accuracy:  0.685
Epoch: 0410 cost = 10.509415800Test accuracy:  0.787
Epoch: 0411 cost = 9.617639195Test accuracy:  0.704
Epoch: 0412 cost = 10.636299133Test accuracy:  0.787
Epoch: 0413 cost = 9.754393838Test accuracy:  0.685
Epoch: 0414 cost = 10.576309681Test accuracy:  0.787
Epoch: 0415 cost = 9.641818740Test accuracy:  0.694
Epoch: 0416 cost = 10.766688737Test accuracy:  0.787
Epoch: 0417 cost = 9.718339703Test accuracy:  0.685
Epoch: 0418 cost = 10.847967625Test accuracy:  0.787
Epoch: 0419 cost = 9.699472471Test accuracy:  0.685
Epoch: 0420 cost = 10.943442301Test accuracy:  0.787
Epoch: 0421 cost = 9.744607319Test accuracy:  0.685
Epoch: 0422 cost = 10.972160599Test accuracy:  0.787
Epoch: 0423 cost = 9.756429282Test accuracy:  0.685
Epoch: 0424 cost = 11.063118675Test accuracy:  0.787
Epoch: 0425 cost = 9.793860045Test accuracy:  0.685
Epoch: 0426 cost = 11.104603074Test accuracy:  0.796
Epoch: 0427 cost = 9.827313293Test accuracy:  0.685
Epoch: 0428 cost = 11.069481026Test accuracy:  0.796
Epoch: 0429 cost = 9.889172077Test accuracy:  0.685
Epoch: 0430 cost = 11.293304140Test accuracy:  0.796
Epoch: 0431 cost = 9.946313381Test accuracy:  0.676
Epoch: 0432 cost = 11.124685851Test accuracy:  0.796
Epoch: 0433 cost = 10.148564209Test accuracy:  0.704
Epoch: 0434 cost = 10.769400423Test accuracy:  0.796
Epoch: 0435 cost = 10.134572506Test accuracy:  0.685
Epoch: 0436 cost = 9.910972335Test accuracy:  0.778
Epoch: 0437 cost = 9.495910471Test accuracy:  0.731
Epoch: 0438 cost = 9.469767354Test accuracy:  0.796
Epoch: 0439 cost = 9.215159330Test accuracy:  0.722
Epoch: 0440 cost = 9.593141729Test accuracy:  0.806
Epoch: 0441 cost = 9.481511940Test accuracy:  0.787
Epoch: 0442 cost = 9.251245325Test accuracy:  0.713
Epoch: 0443 cost = 9.898193880Test accuracy:  0.806
Epoch: 0444 cost = 9.445815997Test accuracy:  0.787
Epoch: 0445 cost = 9.224703962Test accuracy:  0.713
Epoch: 0446 cost = 9.826776461Test accuracy:  0.796
Epoch: 0447 cost = 9.338650573Test accuracy:  0.722
Epoch: 0448 cost = 9.165702343Test accuracy:  0.815
Epoch: 0449 cost = 9.052472505Test accuracy:  0.722
Epoch: 0450 cost = 9.271555771Test accuracy:  0.796
Epoch: 0451 cost = 9.004860965Test accuracy:  0.731
Epoch: 0452 cost = 9.798375953Test accuracy:  0.806
Epoch: 0453 cost = 9.155521870Test accuracy:  0.759
Epoch: 0454 cost = 8.926275947Test accuracy:  0.722
Epoch: 0455 cost = 9.659051895Test accuracy:  0.806
Epoch: 0456 cost = 8.984703237Test accuracy:  0.741
Epoch: 0457 cost = 8.993585933Test accuracy:  0.75
Epoch: 0458 cost = 9.273274032Test accuracy:  0.815
Epoch: 0459 cost = 9.288350929Test accuracy:  0.713
Epoch: 0460 cost = 9.422628186Test accuracy:  0.815
Epoch: 0461 cost = 8.950435075Test accuracy:  0.741
Epoch: 0462 cost = 9.029471701Test accuracy:  0.778
Epoch: 0463 cost = 9.376491763Test accuracy:  0.815
Epoch: 0464 cost = 9.225464041Test accuracy:  0.713
Epoch: 0465 cost = 9.204024358Test accuracy:  0.815
Epoch: 0466 cost = 8.675185507Test accuracy:  0.759
Epoch: 0467 cost = 8.688364441Test accuracy:  0.731
Epoch: 0468 cost = 9.331850702Test accuracy:  0.824
Epoch: 0469 cost = 8.568006212Test accuracy:  0.741
Epoch: 0470 cost = 9.171585863Test accuracy:  0.815
Epoch: 0471 cost = 9.032027765Test accuracy:  0.75
Epoch: 0472 cost = 8.766887838Test accuracy:  0.731
Epoch: 0473 cost = 10.092429595Test accuracy:  0.824
Epoch: 0474 cost = 10.029744018Test accuracy:  0.685
Epoch: 0475 cost = 9.799871791Test accuracy:  0.815
Epoch: 0476 cost = 9.346860626Test accuracy:  0.704
Epoch: 0477 cost = 9.417549653Test accuracy:  0.824
Epoch: 0478 cost = 8.795216820Test accuracy:  0.741
Epoch: 0479 cost = 8.925940167Test accuracy:  0.806
Epoch: 0480 cost = 8.765298193Test accuracy:  0.759
Epoch: 0481 cost = 8.727561387Test accuracy:  0.796
Epoch: 0482 cost = 8.307843750Test accuracy:  0.731
Epoch: 0483 cost = 9.043977781Test accuracy:  0.824
Epoch: 0484 cost = 8.539503401Test accuracy:  0.75
Epoch: 0485 cost = 8.601898150Test accuracy:  0.741
Epoch: 0486 cost = 10.615380287Test accuracy:  0.824
Epoch: 0487 cost = 10.893428499Test accuracy:  0.657
Epoch: 0488 cost = 10.943797025Test accuracy:  0.824
Epoch: 0489 cost = 9.388158321Test accuracy:  0.685
Epoch: 0490 cost = 9.716454376Test accuracy:  0.796
Epoch: 0491 cost = 9.159085621Test accuracy:  0.722
Epoch: 0492 cost = 9.121427406Test accuracy:  0.778
Epoch: 0493 cost = 9.599296483Test accuracy:  0.787
Epoch: 0494 cost = 8.466991078Test accuracy:  0.741
Epoch: 0495 cost = 9.065918142Test accuracy:  0.796
Epoch: 0496 cost = 8.706520687Test accuracy:  0.722
Epoch: 0497 cost = 10.067564401Test accuracy:  0.704
Epoch: 0498 cost = 12.175271945Test accuracy:  0.75
Epoch: 0499 cost = 9.323866237Test accuracy:  0.722
Epoch: 0500 cost = 9.537915230Test accuracy:  0.796
Epoch: 0501 cost = 8.890646804Test accuracy:  0.704
Epoch: 0502 cost = 8.803030383Test accuracy:  0.806
Epoch: 0503 cost = 8.408382502Test accuracy:  0.722
Epoch: 0504 cost = 8.367954037Test accuracy:  0.759
Epoch: 0505 cost = 9.714510874Test accuracy:  0.806
Epoch: 0506 cost = 8.842911677Test accuracy:  0.713
Epoch: 0507 cost = 8.743660103Test accuracy:  0.806
Epoch: 0508 cost = 8.564906944Test accuracy:  0.769
Epoch: 0509 cost = 8.689491532Test accuracy:  0.806
Epoch: 0510 cost = 9.141132095Test accuracy:  0.694
Epoch: 0511 cost = 9.266043360Test accuracy:  0.769
Epoch: 0512 cost = 8.150083043Test accuracy:  0.722
Epoch: 0513 cost = 9.323503538Test accuracy:  0.759
Epoch: 0514 cost = 9.274929610Test accuracy:  0.694
Epoch: 0515 cost = 10.670195146Test accuracy:  0.722
Epoch: 0516 cost = 11.437738939Test accuracy:  0.667
Epoch: 0517 cost = 9.358419765Test accuracy:  0.806
Epoch: 0518 cost = 8.330711191Test accuracy:  0.713
Epoch: 0519 cost = 8.875148947Test accuracy:  0.796
Epoch: 0520 cost = 8.058119644Test accuracy:  0.741
Epoch: 0521 cost = 8.509826162Test accuracy:  0.787
Epoch: 0522 cost = 8.439153129Test accuracy:  0.75
Epoch: 0523 cost = 8.365297903Test accuracy:  0.769
Epoch: 0524 cost = 9.005752412Test accuracy:  0.796
Epoch: 0525 cost = 8.612803329Test accuracy:  0.778
Epoch: 0526 cost = 8.609976032Test accuracy:  0.694
Epoch: 0527 cost = 8.851638100Test accuracy:  0.778
Epoch: 0528 cost = 8.137953151Test accuracy:  0.713
Epoch: 0529 cost = 8.556359399Test accuracy:  0.787
Epoch: 0530 cost = 7.775253036Test accuracy:  0.75
Epoch: 0531 cost = 8.326261585Test accuracy:  0.769
Epoch: 0532 cost = 7.942459562Test accuracy:  0.759
Epoch: 0533 cost = 8.008834470Test accuracy:  0.759
Epoch: 0534 cost = 8.403479056Test accuracy:  0.769
Epoch: 0535 cost = 10.128611044Test accuracy:  0.796
Epoch: 0536 cost = 10.145397793Test accuracy:  0.667
Epoch: 0537 cost = 9.664492650Test accuracy:  0.796
Epoch: 0538 cost = 8.344414104Test accuracy:  0.769
Epoch: 0539 cost = 8.007204576Test accuracy:  0.778
Epoch: 0540 cost = 9.257267432Test accuracy:  0.796
Epoch: 0541 cost = 8.284424002Test accuracy:  0.741
Epoch: 0542 cost = 7.609600739Test accuracy:  0.759
Epoch: 0543 cost = 8.446238106Test accuracy:  0.778
Epoch: 0544 cost = 7.599696766Test accuracy:  0.769
Epoch: 0545 cost = 7.395562757Test accuracy:  0.741
Epoch: 0546 cost = 7.911551909Test accuracy:  0.722
Epoch: 0547 cost = 9.508448492Test accuracy:  0.815
Epoch: 0548 cost = 9.407531912Test accuracy:  0.639
Epoch: 0549 cost = 9.516265046Test accuracy:  0.769
Epoch: 0550 cost = 7.810826302Test accuracy:  0.769
Epoch: 0551 cost = 7.444553722Test accuracy:  0.769
Epoch: 0552 cost = 7.528567206Test accuracy:  0.759
Epoch: 0553 cost = 8.308131955Test accuracy:  0.759
Epoch: 0554 cost = 7.961705013Test accuracy:  0.778
Epoch: 0555 cost = 7.512054400Test accuracy:  0.769
Epoch: 0556 cost = 7.388490720Test accuracy:  0.75
Epoch: 0557 cost = 7.173169743Test accuracy:  0.741
Epoch: 0558 cost = 7.486745748Test accuracy:  0.75
Epoch: 0559 cost = 10.221274203Test accuracy:  0.815
Epoch: 0560 cost = 10.072553461Test accuracy:  0.667
Epoch: 0561 cost = 9.334552548Test accuracy:  0.769
Epoch: 0562 cost = 8.090116501Test accuracy:  0.713
Epoch: 0563 cost = 7.512482296Test accuracy:  0.75
Epoch: 0564 cost = 8.510604598Test accuracy:  0.778
Epoch: 0565 cost = 7.358817447Test accuracy:  0.75
Epoch: 0566 cost = 7.251531623Test accuracy:  0.759
Epoch: 0567 cost = 7.055784702Test accuracy:  0.741
Epoch: 0568 cost = 7.410243294Test accuracy:  0.722
Epoch: 0569 cost = 9.072049509Test accuracy:  0.806
Epoch: 0570 cost = 8.737054998Test accuracy:  0.759
Epoch: 0571 cost = 7.476351955Test accuracy:  0.75
Epoch: 0572 cost = 6.838774724Test accuracy:  0.75
Epoch: 0573 cost = 8.786585764Test accuracy:  0.704
Epoch: 0574 cost = 7.966426546Test accuracy:  0.741
Epoch: 0575 cost = 7.444415439Test accuracy:  0.75
Epoch: 0576 cost = 7.335548531Test accuracy:  0.769
Epoch: 0577 cost = 7.562139988Test accuracy:  0.75
Epoch: 0578 cost = 7.969447526Test accuracy:  0.796
Epoch: 0579 cost = 7.131217480Test accuracy:  0.769
Epoch: 0580 cost = 6.482644775Test accuracy:  0.75
Epoch: 0581 cost = 6.312709332Test accuracy:  0.759
Epoch: 0582 cost = 6.620974042Test accuracy:  0.759
Epoch: 0583 cost = 7.485904217Test accuracy:  0.796
Epoch: 0584 cost = 7.224882949Test accuracy:  0.759
Epoch: 0585 cost = 6.404320478Test accuracy:  0.731
Epoch: 0586 cost = 6.355635730Test accuracy:  0.769
Epoch: 0587 cost = 7.531498432Test accuracy:  0.769
Epoch: 0588 cost = 6.209547823Test accuracy:  0.769
Epoch: 0589 cost = 6.044327866Test accuracy:  0.741
Epoch: 0590 cost = 5.747854146Test accuracy:  0.741
Epoch: 0591 cost = 6.115225575Test accuracy:  0.769
Epoch: 0592 cost = 7.128284086Test accuracy:  0.796
Epoch: 0593 cost = 7.201042804Test accuracy:  0.759
Epoch: 0594 cost = 6.490226811Test accuracy:  0.722
Epoch: 0595 cost = 6.255188985Test accuracy:  0.769
Epoch: 0596 cost = 6.379560731Test accuracy:  0.741
Epoch: 0597 cost = 5.991357110Test accuracy:  0.769
Epoch: 0598 cost = 5.917670662Test accuracy:  0.731
Epoch: 0599 cost = 5.642411080Test accuracy:  0.778
Epoch: 0600 cost = 5.380883455Test accuracy:  0.759
Epoch: 0601 cost = 5.284918048Test accuracy:  0.778
Epoch: 0602 cost = 5.010589816Test accuracy:  0.741
Epoch: 0603 cost = 4.990928888Test accuracy:  0.759
Epoch: 0604 cost = 4.978739652Test accuracy:  0.778
Epoch: 0605 cost = 4.713790872Test accuracy:  0.759
Epoch: 0606 cost = 4.719433524Test accuracy:  0.778
Epoch: 0607 cost = 4.665872335Test accuracy:  0.778
Epoch: 0608 cost = 4.753575108Test accuracy:  0.759
Epoch: 0609 cost = 4.466248577Test accuracy:  0.787
Epoch: 0610 cost = 4.587587855Test accuracy:  0.769
Epoch: 0611 cost = 4.346694166Test accuracy:  0.778
Epoch: 0612 cost = 4.756721128Test accuracy:  0.75
Epoch: 0613 cost = 4.814056071Test accuracy:  0.731
Epoch: 0614 cost = 5.952937841Test accuracy:  0.731
Epoch: 0615 cost = 6.367590254Test accuracy:  0.722
Epoch: 0616 cost = 7.423973105Test accuracy:  0.741
Epoch: 0617 cost = 6.911172693Test accuracy:  0.731
Epoch: 0618 cost = 7.535702489Test accuracy:  0.787
Epoch: 0619 cost = 6.961139115Test accuracy:  0.759
Epoch: 0620 cost = 4.383015568Test accuracy:  0.769
Epoch: 0621 cost = 4.277601773Test accuracy:  0.787
Epoch: 0622 cost = 4.411717827Test accuracy:  0.778
Epoch: 0623 cost = 3.880661260Test accuracy:  0.787
Epoch: 0624 cost = 3.625095454Test accuracy:  0.778
Epoch: 0625 cost = 4.530913992Test accuracy:  0.759
Epoch: 0626 cost = 4.247458436Test accuracy:  0.778
Epoch: 0627 cost = 4.837388700Test accuracy:  0.731
Epoch: 0628 cost = 4.586200844Test accuracy:  0.75
Epoch: 0629 cost = 3.941335895Test accuracy:  0.759
Epoch: 0630 cost = 3.518160484Test accuracy:  0.75
Epoch: 0631 cost = 3.923958973Test accuracy:  0.75
Epoch: 0632 cost = 4.416993250Test accuracy:  0.75
Epoch: 0633 cost = 8.172803825Test accuracy:  0.824
Epoch: 0634 cost = 9.592318318Test accuracy:  0.694
Epoch: 0635 cost = 8.098462018Test accuracy:  0.778
Epoch: 0636 cost = 7.144737157Test accuracy:  0.713
Epoch: 0637 cost = 5.792240663Test accuracy:  0.722
Epoch: 0638 cost = 4.952984246Test accuracy:  0.769
Epoch: 0639 cost = 4.417701873Test accuracy:  0.75
Epoch: 0640 cost = 3.740036574Test accuracy:  0.75
Epoch: 0641 cost = 4.125993187Test accuracy:  0.759
Epoch: 0642 cost = 3.926453536Test accuracy:  0.778
Epoch: 0643 cost = 3.832284147Test accuracy:  0.75
Epoch: 0644 cost = 3.253503106Test accuracy:  0.778
Epoch: 0645 cost = 4.031358307Test accuracy:  0.769
Epoch: 0646 cost = 4.038118666Test accuracy:  0.796
Epoch: 0647 cost = 3.715142380Test accuracy:  0.759
Epoch: 0648 cost = 3.394183094Test accuracy:  0.741
Epoch: 0649 cost = 3.453905572Test accuracy:  0.75
Epoch: 0650 cost = 3.993039673Test accuracy:  0.769
Epoch: 0651 cost = 3.393756455Test accuracy:  0.815
Epoch: 0652 cost = 3.704998797Test accuracy:  0.759
Epoch: 0653 cost = 3.046211167Test accuracy:  0.75
Epoch: 0654 cost = 3.680647438Test accuracy:  0.759
Epoch: 0655 cost = 4.182436455Test accuracy:  0.833
Epoch: 0656 cost = 3.723917723Test accuracy:  0.741
Epoch: 0657 cost = 3.115181988Test accuracy:  0.75
Epoch: 0658 cost = 3.079592401Test accuracy:  0.769
Epoch: 0659 cost = 4.527440461Test accuracy:  0.778
Epoch: 0660 cost = 4.122890733Test accuracy:  0.722
Epoch: 0661 cost = 3.620809447Test accuracy:  0.759
Epoch: 0662 cost = 3.079945478Test accuracy:  0.75
Epoch: 0663 cost = 3.245243799Test accuracy:  0.759
Epoch: 0664 cost = 2.817826748Test accuracy:  0.759
Epoch: 0665 cost = 2.502189230Test accuracy:  0.778
Epoch: 0666 cost = 2.346316804Test accuracy:  0.769
Epoch: 0667 cost = 2.265637506Test accuracy:  0.75
Epoch: 0668 cost = 2.239576242Test accuracy:  0.759
Epoch: 0669 cost = 2.158817389Test accuracy:  0.769
Epoch: 0670 cost = 2.072797840Test accuracy:  0.769
Epoch: 0671 cost = 2.009020307Test accuracy:  0.769
Epoch: 0672 cost = 1.988558813Test accuracy:  0.759
Epoch: 0673 cost = 2.029056403Test accuracy:  0.769
Epoch: 0674 cost = 1.948834603Test accuracy:  0.759
Epoch: 0675 cost = 1.944450671Test accuracy:  0.741
Epoch: 0676 cost = 2.060857865Test accuracy:  0.75
Epoch: 0677 cost = 2.230627634Test accuracy:  0.722
Epoch: 0678 cost = 2.350694104Test accuracy:  0.759
Epoch: 0679 cost = 2.248867398Test accuracy:  0.731
Epoch: 0680 cost = 2.325795445Test accuracy:  0.722
Epoch: 0681 cost = 3.075863220Test accuracy:  0.769
Epoch: 0682 cost = 3.984688976Test accuracy:  0.731
Epoch: 0683 cost = 13.004232905Test accuracy:  0.685
Epoch: 0684 cost = 11.261872378Test accuracy:  0.713
Epoch: 0685 cost = 9.495563074Test accuracy:  0.667
Epoch: 0686 cost = 7.786230477Test accuracy:  0.722
Epoch: 0687 cost = 6.161246278Test accuracy:  0.722
Epoch: 0688 cost = 6.535942706Test accuracy:  0.75
Epoch: 0689 cost = 5.917465167Test accuracy:  0.741
Epoch: 0690 cost = 5.895240589Test accuracy:  0.731
Epoch: 0691 cost = 5.280596538Test accuracy:  0.75
Epoch: 0692 cost = 4.789703478Test accuracy:  0.731
Epoch: 0693 cost = 4.489258484Test accuracy:  0.722
Epoch: 0694 cost = 4.043991046Test accuracy:  0.741
Epoch: 0695 cost = 3.890425877Test accuracy:  0.722
Epoch: 0696 cost = 3.653783083Test accuracy:  0.731
Epoch: 0697 cost = 3.361050942Test accuracy:  0.731
Epoch: 0698 cost = 2.997571934Test accuracy:  0.741
Epoch: 0699 cost = 2.627807736Test accuracy:  0.759
Epoch: 0700 cost = 2.469900532Test accuracy:  0.769
Epoch: 0701 cost = 3.536587780Test accuracy:  0.731
Epoch: 0702 cost = 8.563742042Test accuracy:  0.75
Epoch: 0703 cost = 7.566338442Test accuracy:  0.741
Epoch: 0704 cost = 7.037507989Test accuracy:  0.713
Epoch: 0705 cost = 4.157395970Test accuracy:  0.704
Epoch: 0706 cost = 3.397224329Test accuracy:  0.759
Epoch: 0707 cost = 3.452890223Test accuracy:  0.759
Epoch: 0708 cost = 2.590644847Test accuracy:  0.75
Epoch: 0709 cost = 2.240086138Test accuracy:  0.759
Epoch: 0710 cost = 2.202566385Test accuracy:  0.769
Epoch: 0711 cost = 1.857668053Test accuracy:  0.759
Epoch: 0712 cost = 1.824838021Test accuracy:  0.769
Epoch: 0713 cost = 1.805681332Test accuracy:  0.769
Epoch: 0714 cost = 1.676513314Test accuracy:  0.769
Epoch: 0715 cost = 1.730446967Test accuracy:  0.778
Epoch: 0716 cost = 1.690439083Test accuracy:  0.769
Epoch: 0717 cost = 1.629320578Test accuracy:  0.769
Epoch: 0718 cost = 1.658316493Test accuracy:  0.769
Epoch: 0719 cost = 1.601992493Test accuracy:  0.787
Epoch: 0720 cost = 1.574712434Test accuracy:  0.769
Epoch: 0721 cost = 1.465943575Test accuracy:  0.759
Epoch: 0722 cost = 1.544110672Test accuracy:  0.769
Epoch: 0723 cost = 2.189457682Test accuracy:  0.787
Epoch: 0724 cost = 2.007623710Test accuracy:  0.759
Epoch: 0725 cost = 1.721637455Test accuracy:  0.75
Epoch: 0726 cost = 1.540157118Test accuracy:  0.759
Epoch: 0727 cost = 1.746733546Test accuracy:  0.769
Epoch: 0728 cost = 3.687426025Test accuracy:  0.731
Epoch: 0729 cost = 6.708656376Test accuracy:  0.685
Epoch: 0730 cost = 8.339676662Test accuracy:  0.713
Epoch: 0731 cost = 8.921731299Test accuracy:  0.75
Epoch: 0732 cost = 5.753609115Test accuracy:  0.731
Epoch: 0733 cost = 4.055799766Test accuracy:  0.759
Epoch: 0734 cost = 3.895636049Test accuracy:  0.731
Epoch: 0735 cost = 3.212343649Test accuracy:  0.787
Epoch: 0736 cost = 3.241352710Test accuracy:  0.75
Epoch: 0737 cost = 2.232012868Test accuracy:  0.769
Epoch: 0738 cost = 2.353225231Test accuracy:  0.75
Epoch: 0739 cost = 2.500870683Test accuracy:  0.778
Epoch: 0740 cost = 3.036824205Test accuracy:  0.759
Epoch: 0741 cost = 1.839407368Test accuracy:  0.75
Epoch: 0742 cost = 1.699752510Test accuracy:  0.769
Epoch: 0743 cost = 1.798822284Test accuracy:  0.769
Epoch: 0744 cost = 1.688887694Test accuracy:  0.741
Epoch: 0745 cost = 1.530437843Test accuracy:  0.778
Epoch: 0746 cost = 1.435589612Test accuracy:  0.75
Epoch: 0747 cost = 1.488659057Test accuracy:  0.769
Epoch: 0748 cost = 1.754257587Test accuracy:  0.75
Epoch: 0749 cost = 1.807792279Test accuracy:  0.75
Epoch: 0750 cost = 1.567074413Test accuracy:  0.787
Epoch: 0751 cost = 1.682265964Test accuracy:  0.731
Epoch: 0752 cost = 1.345047897Test accuracy:  0.75
Epoch: 0753 cost = 3.220415874Test accuracy:  0.75
Epoch: 0754 cost = 9.431060802Test accuracy:  0.806
Epoch: 0755 cost = 7.564236251Test accuracy:  0.731
Epoch: 0756 cost = 9.217165448Test accuracy:  0.657
Epoch: 0757 cost = 6.336947896Test accuracy:  0.722
Epoch: 0758 cost = 4.336835948Test accuracy:  0.759
Epoch: 0759 cost = 3.537646283Test accuracy:  0.741
Epoch: 0760 cost = 3.227406849Test accuracy:  0.759
Epoch: 0761 cost = 2.691798438Test accuracy:  0.759
Epoch: 0762 cost = 2.260627432Test accuracy:  0.759
Epoch: 0763 cost = 2.121895844Test accuracy:  0.759
Epoch: 0764 cost = 2.010280441Test accuracy:  0.778
Epoch: 0765 cost = 2.039964708Test accuracy:  0.759
Epoch: 0766 cost = 1.921782066Test accuracy:  0.75
Epoch: 0767 cost = 1.855101526Test accuracy:  0.759
Epoch: 0768 cost = 1.655869267Test accuracy:  0.769
Epoch: 0769 cost = 1.651919381Test accuracy:  0.75
Epoch: 0770 cost = 1.848636107Test accuracy:  0.778
Epoch: 0771 cost = 1.739385670Test accuracy:  0.75
Epoch: 0772 cost = 1.347627951Test accuracy:  0.759
Epoch: 0773 cost = 1.330287321Test accuracy:  0.769
Epoch: 0774 cost = 1.186146254Test accuracy:  0.741
Epoch: 0775 cost = 1.252548421Test accuracy:  0.769
Epoch: 0776 cost = 1.180574593Test accuracy:  0.75
Epoch: 0777 cost = 1.355841780Test accuracy:  0.769
Epoch: 0778 cost = 1.218922523Test accuracy:  0.75
Epoch: 0779 cost = 1.282383659Test accuracy:  0.769
Epoch: 0780 cost = 1.162819250Test accuracy:  0.769
Epoch: 0781 cost = 1.178143928Test accuracy:  0.75
Epoch: 0782 cost = 3.421613672Test accuracy:  0.759
Epoch: 0783 cost = 8.190576391Test accuracy:  0.769
Epoch: 0784 cost = 6.343078841Test accuracy:  0.778
Epoch: 0785 cost = 5.472633253Test accuracy:  0.731
Epoch: 0786 cost = 4.498098525Test accuracy:  0.741
Epoch: 0787 cost = 3.425640095Test accuracy:  0.722
Epoch: 0788 cost = 2.359585767Test accuracy:  0.75
Epoch: 0789 cost = 1.904452584Test accuracy:  0.769
Epoch: 0790 cost = 1.856083138Test accuracy:  0.769
Epoch: 0791 cost = 1.688188515Test accuracy:  0.759
Epoch: 0792 cost = 1.558488700Test accuracy:  0.769
Epoch: 0793 cost = 1.263275626Test accuracy:  0.759
Epoch: 0794 cost = 1.253306029Test accuracy:  0.778
Epoch: 0795 cost = 1.463291336Test accuracy:  0.778
Epoch: 0796 cost = 1.261379990Test accuracy:  0.769
Epoch: 0797 cost = 1.136971577Test accuracy:  0.759
Epoch: 0798 cost = 1.082364584Test accuracy:  0.769
Epoch: 0799 cost = 1.170517873Test accuracy:  0.759
Epoch: 0800 cost = 1.792081998Test accuracy:  0.778
Epoch: 0801 cost = 3.214300351Test accuracy:  0.759
Epoch: 0802 cost = 3.105870791Test accuracy:  0.769
Epoch: 0803 cost = 2.192963695Test accuracy:  0.769
Epoch: 0804 cost = 1.666754571Test accuracy:  0.778
Epoch: 0805 cost = 2.031162048Test accuracy:  0.787
Epoch: 0806 cost = 4.349439632Test accuracy:  0.787
Epoch: 0807 cost = 3.929642038Test accuracy:  0.787
Epoch: 0808 cost = 2.928392362Test accuracy:  0.731
Epoch: 0809 cost = 2.489415960Test accuracy:  0.75
Epoch: 0810 cost = 2.194953350Test accuracy:  0.741
Epoch: 0811 cost = 1.996861688Test accuracy:  0.778
Epoch: 0812 cost = 2.389149547Test accuracy:  0.731
Epoch: 0813 cost = 1.489131177Test accuracy:  0.778
Epoch: 0814 cost = 1.509539713Test accuracy:  0.769
Epoch: 0815 cost = 1.134398781Test accuracy:  0.759
Epoch: 0816 cost = 1.300887173Test accuracy:  0.741
Epoch: 0817 cost = 1.710591403Test accuracy:  0.778
Epoch: 0818 cost = 1.248890506Test accuracy:  0.75
Epoch: 0819 cost = 1.040019405Test accuracy:  0.741
Epoch: 0820 cost = 1.057695039Test accuracy:  0.787
Epoch: 0821 cost = 1.072452404Test accuracy:  0.759
Epoch: 0822 cost = 0.827255171Test accuracy:  0.75
Epoch: 0823 cost = 0.933096108Test accuracy:  0.769
Epoch: 0824 cost = 1.175527063Test accuracy:  0.759
Epoch: 0825 cost = 2.549650704Test accuracy:  0.759
Epoch: 0826 cost = 3.267054961Test accuracy:  0.778
Epoch: 0827 cost = 2.859996010Test accuracy:  0.741
Epoch: 0828 cost = 2.143451902Test accuracy:  0.769
Epoch: 0829 cost = 2.680228418Test accuracy:  0.778
Epoch: 0830 cost = 1.946919723Test accuracy:  0.769
Epoch: 0831 cost = 1.332522138Test accuracy:  0.759
Epoch: 0832 cost = 1.058716686Test accuracy:  0.759
Epoch: 0833 cost = 0.952825343Test accuracy:  0.741
Epoch: 0834 cost = 0.961471860Test accuracy:  0.769
Epoch: 0835 cost = 1.086737752Test accuracy:  0.759
Epoch: 0836 cost = 0.854676864Test accuracy:  0.759
Epoch: 0837 cost = 0.807782720Test accuracy:  0.759
Epoch: 0838 cost = 0.821116617Test accuracy:  0.759
Epoch: 0839 cost = 0.773559439Test accuracy:  0.769
Epoch: 0840 cost = 0.696902782Test accuracy:  0.759
Epoch: 0841 cost = 0.661973384Test accuracy:  0.759
Epoch: 0842 cost = 0.654250569Test accuracy:  0.778
Epoch: 0843 cost = 0.571703283Test accuracy:  0.769
Epoch: 0844 cost = 0.840147383Test accuracy:  0.759
Epoch: 0845 cost = 2.699335427Test accuracy:  0.741
Epoch: 0846 cost = 2.647499643Test accuracy:  0.787
Epoch: 0847 cost = 1.176580608Test accuracy:  0.759
Epoch: 0848 cost = 1.453532750Test accuracy:  0.787
Epoch: 0849 cost = 1.613096134Test accuracy:  0.769
Epoch: 0850 cost = 0.980769851Test accuracy:  0.741
Epoch: 0851 cost = 0.810327015Test accuracy:  0.769
Epoch: 0852 cost = 0.671343956Test accuracy:  0.769
Epoch: 0853 cost = 0.973152427Test accuracy:  0.769
Epoch: 0854 cost = 0.919688424Test accuracy:  0.759
Epoch: 0855 cost = 2.527200252Test accuracy:  0.778
Epoch: 0856 cost = 2.544464266Test accuracy:  0.769
Epoch: 0857 cost = 2.399606972Test accuracy:  0.769
Epoch: 0858 cost = 1.914918027Test accuracy:  0.759
Epoch: 0859 cost = 1.508341445Test accuracy:  0.759
Epoch: 0860 cost = 1.175695102Test accuracy:  0.759
Epoch: 0861 cost = 3.200665322Test accuracy:  0.769
Epoch: 0862 cost = 7.411796467Test accuracy:  0.806
Epoch: 0863 cost = 5.848715381Test accuracy:  0.741
Epoch: 0864 cost = 2.526412720Test accuracy:  0.75
Epoch: 0865 cost = 1.603218366Test accuracy:  0.769
Epoch: 0866 cost = 1.631366600Test accuracy:  0.778
Epoch: 0867 cost = 1.158386610Test accuracy:  0.778
Epoch: 0868 cost = 1.062271898Test accuracy:  0.741
Epoch: 0869 cost = 1.122530049Test accuracy:  0.769
Epoch: 0870 cost = 1.225105567Test accuracy:  0.75
Epoch: 0871 cost = 1.770670054Test accuracy:  0.741
Epoch: 0872 cost = 1.407794229Test accuracy:  0.759
Epoch: 0873 cost = 1.015146082Test accuracy:  0.778
Epoch: 0874 cost = 0.742513630Test accuracy:  0.778
Epoch: 0875 cost = 0.766073463Test accuracy:  0.787
Epoch: 0876 cost = 0.622747895Test accuracy:  0.778
Epoch: 0877 cost = 0.489136134Test accuracy:  0.778
Epoch: 0878 cost = 0.457655928Test accuracy:  0.787
Epoch: 0879 cost = 0.468588676Test accuracy:  0.769
Epoch: 0880 cost = 0.498891679Test accuracy:  0.759
Epoch: 0881 cost = 0.475623499Test accuracy:  0.769
Epoch: 0882 cost = 0.381875138Test accuracy:  0.778
Epoch: 0883 cost = 0.375822527Test accuracy:  0.778
Epoch: 0884 cost = 0.378252812Test accuracy:  0.778
Epoch: 0885 cost = 0.380660281Test accuracy:  0.778
Epoch: 0886 cost = 0.350002477Test accuracy:  0.778
Epoch: 0887 cost = 0.367608612Test accuracy:  0.769
Epoch: 0888 cost = 0.341873338Test accuracy:  0.769
Epoch: 0889 cost = 0.370082227Test accuracy:  0.769
Epoch: 0890 cost = 0.338499990Test accuracy:  0.759
Epoch: 0891 cost = 0.341877654Test accuracy:  0.769
Epoch: 0892 cost = 0.321793745Test accuracy:  0.75
Epoch: 0893 cost = 0.403087704Test accuracy:  0.75
Epoch: 0894 cost = 0.388508437Test accuracy:  0.759
Epoch: 0895 cost = 0.309569683Test accuracy:  0.759
Epoch: 0896 cost = 0.325294489Test accuracy:  0.769
Epoch: 0897 cost = 0.557172096Test accuracy:  0.759
Epoch: 0898 cost = 0.598206803Test accuracy:  0.759
Epoch: 0899 cost = 0.903082507Test accuracy:  0.769
Epoch: 0900 cost = 1.013372417Test accuracy:  0.769
Epoch: 0901 cost = 2.144254489Test accuracy:  0.741
Epoch: 0902 cost = 3.131055187Test accuracy:  0.731
Epoch: 0903 cost = 4.920466087Test accuracy:  0.778
Epoch: 0904 cost = 6.921017939Test accuracy:  0.769
Epoch: 0905 cost = 3.843683172Test accuracy:  0.741
Epoch: 0906 cost = 2.654961743Test accuracy:  0.704
Epoch: 0907 cost = 3.451299797Test accuracy:  0.731
Epoch: 0908 cost = 4.158230196Test accuracy:  0.778
Epoch: 0909 cost = 4.092939821Test accuracy:  0.722
Epoch: 0910 cost = 1.957159443Test accuracy:  0.75
Epoch: 0911 cost = 1.971966242Test accuracy:  0.815
Epoch: 0912 cost = 3.478078864Test accuracy:  0.759
Epoch: 0913 cost = 2.184947496Test accuracy:  0.75
Epoch: 0914 cost = 1.825151639Test accuracy:  0.787
Epoch: 0915 cost = 1.434895618Test accuracy:  0.704
Epoch: 0916 cost = 1.636678295Test accuracy:  0.769
Epoch: 0917 cost = 1.527707766Test accuracy:  0.75
Epoch: 0918 cost = 1.011733779Test accuracy:  0.741
Epoch: 0919 cost = 0.982645890Test accuracy:  0.787
Epoch: 0920 cost = 0.844577523Test accuracy:  0.741
Epoch: 0921 cost = 0.714129140Test accuracy:  0.759
Epoch: 0922 cost = 0.998596265Test accuracy:  0.769
Epoch: 0923 cost = 1.200799334Test accuracy:  0.778
Epoch: 0924 cost = 2.518545480Test accuracy:  0.796
Epoch: 0925 cost = 1.907286503Test accuracy:  0.731
Epoch: 0926 cost = 2.280988149Test accuracy:  0.759
Epoch: 0927 cost = 1.482706796Test accuracy:  0.778
Epoch: 0928 cost = 1.505900103Test accuracy:  0.769
Epoch: 0929 cost = 0.954444268Test accuracy:  0.759
Epoch: 0930 cost = 0.786215639Test accuracy:  0.759
Epoch: 0931 cost = 0.625909620Test accuracy:  0.759
Epoch: 0932 cost = 0.626663709Test accuracy:  0.769
Epoch: 0933 cost = 0.554234749Test accuracy:  0.759
Epoch: 0934 cost = 0.434620506Test accuracy:  0.759
Epoch: 0935 cost = 0.401677709Test accuracy:  0.75
Epoch: 0936 cost = 0.519315265Test accuracy:  0.759
Epoch: 0937 cost = 0.622823408Test accuracy:  0.722
Epoch: 0938 cost = 1.020222740Test accuracy:  0.75
Epoch: 0939 cost = 1.352869015Test accuracy:  0.769
Epoch: 0940 cost = 8.913176780Test accuracy:  0.704
Epoch: 0941 cost = 4.053823271Test accuracy:  0.759
Epoch: 0942 cost = 1.695196829Test accuracy:  0.815
Epoch: 0943 cost = 1.855843322Test accuracy:  0.731
Epoch: 0944 cost = 2.317202449Test accuracy:  0.778
Epoch: 0945 cost = 0.914228689Test accuracy:  0.769
Epoch: 0946 cost = 0.806014527Test accuracy:  0.769
Epoch: 0947 cost = 0.623369858Test accuracy:  0.778
Epoch: 0948 cost = 0.571732702Test accuracy:  0.778
Epoch: 0949 cost = 0.519991078Test accuracy:  0.769
Epoch: 0950 cost = 0.470680946Test accuracy:  0.759
Epoch: 0951 cost = 0.455091894Test accuracy:  0.759
Epoch: 0952 cost = 0.430054320Test accuracy:  0.759
Epoch: 0953 cost = 0.424115237Test accuracy:  0.759
Epoch: 0954 cost = 0.426235368Test accuracy:  0.759
Epoch: 0955 cost = 0.405343526Test accuracy:  0.759
Epoch: 0956 cost = 0.485474208Test accuracy:  0.759
Epoch: 0957 cost = 0.396931001Test accuracy:  0.759
Epoch: 0958 cost = 0.530165655Test accuracy:  0.75
Epoch: 0959 cost = 0.671017292Test accuracy:  0.759
Epoch: 0960 cost = 1.440787620Test accuracy:  0.75
Epoch: 0961 cost = 0.952791644Test accuracy:  0.759
Epoch: 0962 cost = 1.585982915Test accuracy:  0.787
Epoch: 0963 cost = 0.774530703Test accuracy:  0.769
Epoch: 0964 cost = 0.549696675Test accuracy:  0.778
Epoch: 0965 cost = 0.482944712Test accuracy:  0.778
Epoch: 0966 cost = 0.399640440Test accuracy:  0.778
Epoch: 0967 cost = 0.394341592Test accuracy:  0.769
Epoch: 0968 cost = 0.431163661Test accuracy:  0.759
Epoch: 0969 cost = 0.715962553Test accuracy:  0.769
Epoch: 0970 cost = 0.512340357Test accuracy:  0.741
Epoch: 0971 cost = 0.632514330Test accuracy:  0.778
Epoch: 0972 cost = 0.477949185Test accuracy:  0.769
Epoch: 0973 cost = 0.509669144Test accuracy:  0.759
Epoch: 0974 cost = 0.979213718Test accuracy:  0.75
Epoch: 0975 cost = 0.561103477Test accuracy:  0.741
Epoch: 0976 cost = 0.454077968Test accuracy:  0.741
Epoch: 0977 cost = 0.352400473Test accuracy:  0.741
Epoch: 0978 cost = 0.313669535Test accuracy:  0.741
Epoch: 0979 cost = 0.294739060Test accuracy:  0.75
Epoch: 0980 cost = 0.296925064Test accuracy:  0.75
Epoch: 0981 cost = 0.296557803Test accuracy:  0.75
Epoch: 0982 cost = 0.330136247Test accuracy:  0.75
Epoch: 0983 cost = 0.542117558Test accuracy:  0.75
Epoch: 0984 cost = 0.390366716Test accuracy:  0.769
Epoch: 0985 cost = 0.617496899Test accuracy:  0.75
Epoch: 0986 cost = 0.564917180Test accuracy:  0.769
Epoch: 0987 cost = 0.492725406Test accuracy:  0.75
Epoch: 0988 cost = 0.335911175Test accuracy:  0.75
Epoch: 0989 cost = 0.565078433Test accuracy:  0.741
Epoch: 0990 cost = 0.379851090Test accuracy:  0.741
Epoch: 0991 cost = 1.003252403Test accuracy:  0.759
Epoch: 0992 cost = 0.774984358Test accuracy:  0.741
Epoch: 0993 cost = 0.417216702Test accuracy:  0.759
Epoch: 0994 cost = 0.309665258Test accuracy:  0.759
Epoch: 0995 cost = 0.306294295Test accuracy:  0.75
Epoch: 0996 cost = 0.304455182Test accuracy:  0.741
Epoch: 0997 cost = 0.262131426Test accuracy:  0.75
Epoch: 0998 cost = 0.293934803Test accuracy:  0.759
Epoch: 0999 cost = 0.367416390Test accuracy:  0.769
Epoch: 1000 cost = 0.290669055Test accuracy:  0.769
Epoch: 1001 cost = 0.434766409Test accuracy:  0.75
Epoch: 1002 cost = 0.893864533Test accuracy:  0.759
Epoch: 1003 cost = 1.038224542Test accuracy:  0.75
Epoch: 1004 cost = 4.503483148Test accuracy:  0.741
Epoch: 1005 cost = 17.088321073Test accuracy:  0.741
Epoch: 1006 cost = 10.689144351Test accuracy:  0.694
Epoch: 1007 cost = 6.601486076Test accuracy:  0.778
Epoch: 1008 cost = 4.296371525Test accuracy:  0.713
Epoch: 1009 cost = 2.843334631Test accuracy:  0.75
Epoch: 1010 cost = 2.777036255Test accuracy:  0.759
Epoch: 1011 cost = 1.750633570Test accuracy:  0.759
Epoch: 1012 cost = 1.409447480Test accuracy:  0.769
Epoch: 1013 cost = 1.207003534Test accuracy:  0.769
Epoch: 1014 cost = 1.049988007Test accuracy:  0.759
Epoch: 1015 cost = 0.995400182Test accuracy:  0.769
Epoch: 1016 cost = 0.902911316Test accuracy:  0.759
Epoch: 1017 cost = 0.842532337Test accuracy:  0.759
Epoch: 1018 cost = 0.768069869Test accuracy:  0.759
Epoch: 1019 cost = 0.721276692Test accuracy:  0.759
Epoch: 1020 cost = 0.673902155Test accuracy:  0.759
Epoch: 1021 cost = 0.627591828Test accuracy:  0.759
Epoch: 1022 cost = 0.584576692Test accuracy:  0.759
Epoch: 1023 cost = 0.562132544Test accuracy:  0.769
Epoch: 1024 cost = 0.545481814Test accuracy:  0.769
Epoch: 1025 cost = 0.504773919Test accuracy:  0.75
Epoch: 1026 cost = 0.422542996Test accuracy:  0.75
Epoch: 1027 cost = 0.391789491Test accuracy:  0.769
Epoch: 1028 cost = 0.406423989Test accuracy:  0.769
Epoch: 1029 cost = 0.810586541Test accuracy:  0.769
Epoch: 1030 cost = 0.715055252Test accuracy:  0.741
Epoch: 1031 cost = 0.838552337Test accuracy:  0.759
Epoch: 1032 cost = 0.568281419Test accuracy:  0.759
Epoch: 1033 cost = 0.544005229Test accuracy:  0.75
Epoch: 1034 cost = 0.391328485Test accuracy:  0.75
Epoch: 1035 cost = 1.127327440Test accuracy:  0.741
Epoch: 1036 cost = 0.805163029Test accuracy:  0.769
Epoch: 1037 cost = 0.403646736Test accuracy:  0.769
Epoch: 1038 cost = 0.390807463Test accuracy:  0.75
Epoch: 1039 cost = 0.313551350Test accuracy:  0.759
Epoch: 1040 cost = 0.312905100Test accuracy:  0.759
Epoch: 1041 cost = 0.375322133Test accuracy:  0.759
Epoch: 1042 cost = 0.317735880Test accuracy:  0.778
Epoch: 1043 cost = 1.601769915Test accuracy:  0.75
Epoch: 1044 cost = 2.686527675Test accuracy:  0.778
Epoch: 1045 cost = 4.124468531Test accuracy:  0.694
Epoch: 1046 cost = 2.883371855Test accuracy:  0.759
Epoch: 1047 cost = 2.919426247Test accuracy:  0.778
Epoch: 1048 cost = 2.174618557Test accuracy:  0.787
Epoch: 1049 cost = 1.287362810Test accuracy:  0.769
Epoch: 1050 cost = 1.117687056Test accuracy:  0.769
Epoch: 1051 cost = 0.902441522Test accuracy:  0.769
Epoch: 1052 cost = 0.667298489Test accuracy:  0.759
Epoch: 1053 cost = 0.580565695Test accuracy:  0.741
Epoch: 1054 cost = 0.558855071Test accuracy:  0.759
Epoch: 1055 cost = 0.485015406Test accuracy:  0.741
Epoch: 1056 cost = 0.415426973Test accuracy:  0.759
Epoch: 1057 cost = 0.415430703Test accuracy:  0.741
Epoch: 1058 cost = 0.323767414Test accuracy:  0.759
Epoch: 1059 cost = 0.363854488Test accuracy:  0.741
Epoch: 1060 cost = 0.327381269Test accuracy:  0.769
Epoch: 1061 cost = 0.362059333Test accuracy:  0.741
Epoch: 1062 cost = 0.292277556Test accuracy:  0.759
Epoch: 1063 cost = 0.398882485Test accuracy:  0.759
Epoch: 1064 cost = 0.241822082Test accuracy:  0.741
Epoch: 1065 cost = 0.320556573Test accuracy:  0.759
Epoch: 1066 cost = 0.194728729Test accuracy:  0.741
Epoch: 1067 cost = 0.249366899Test accuracy:  0.759
Epoch: 1068 cost = 0.222526198Test accuracy:  0.741
Epoch: 1069 cost = 0.271663600Test accuracy:  0.75
Epoch: 1070 cost = 0.184713075Test accuracy:  0.75
Epoch: 1071 cost = 0.286943241Test accuracy:  0.741
Epoch: 1072 cost = 0.298525725Test accuracy:  0.741
Epoch: 1073 cost = 0.591938661Test accuracy:  0.759
Epoch: 1074 cost = 0.377938833Test accuracy:  0.759
Epoch: 1075 cost = 0.291050415Test accuracy:  0.769
Epoch: 1076 cost = 0.511725680Test accuracy:  0.75
Epoch: 1077 cost = 0.267441565Test accuracy:  0.75
Epoch: 1078 cost = 0.397133561Test accuracy:  0.759
Epoch: 1079 cost = 0.355721821Test accuracy:  0.759
Epoch: 1080 cost = 0.298092179Test accuracy:  0.741
Epoch: 1081 cost = 0.651164715Test accuracy:  0.759
Epoch: 1082 cost = 0.762278595Test accuracy:  0.787
Epoch: 1083 cost = 3.531529602Test accuracy:  0.787
Epoch: 1084 cost = 6.736873369Test accuracy:  0.769
Epoch: 1085 cost = 20.345717083Test accuracy:  0.778
Epoch: 1086 cost = 3.849979157Test accuracy:  0.75
Epoch: 1087 cost = 2.007661679Test accuracy:  0.787
---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
<ipython-input-9-ea695e17b974> in <module>
     13             batch_y = tr_labels[start:end]
     14 
---> 15             _, c = session.run([optimizer, loss_f], feed_dict={x: batch_x, y : batch_y})
     16             avg_cost += c / total_batch
     17 

~\Miniconda3\lib\site-packages\tensorflow\python\client\session.py in run(self, fetches, feed_dict, options, run_metadata)
    927     try:
    928       result = self._run(None, fetches, feed_dict, options_ptr,
--> 929                          run_metadata_ptr)
    930       if run_metadata:
    931         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)

~\Miniconda3\lib\site-packages\tensorflow\python\client\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)
   1150     if final_fetches or final_targets or (handle and feed_dict_tensor):
   1151       results = self._do_run(handle, final_targets, final_fetches,
-> 1152                              feed_dict_tensor, options, run_metadata)
   1153     else:
   1154       results = []

~\Miniconda3\lib\site-packages\tensorflow\python\client\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)
   1326     if handle is None:
   1327       return self._do_call(_run_fn, feeds, fetches, targets, options,
-> 1328                            run_metadata)
   1329     else:
   1330       return self._do_call(_prun_fn, handle, feeds, fetches)

~\Miniconda3\lib\site-packages\tensorflow\python\client\session.py in _do_call(self, fn, *args)
   1332   def _do_call(self, fn, *args):
   1333     try:
-> 1334       return fn(*args)
   1335     except errors.OpError as e:
   1336       message = compat.as_text(e.message)

~\Miniconda3\lib\site-packages\tensorflow\python\client\session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)
   1317       self._extend_graph()
   1318       return self._call_tf_sessionrun(
-> 1319           options, feed_dict, fetch_list, target_list, run_metadata)
   1320 
   1321     def _prun_fn(handle, feed_dict, fetch_list):

~\Miniconda3\lib\site-packages\tensorflow\python\client\session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)
   1405     return tf_session.TF_SessionRun_wrapper(
   1406         self._session, options, feed_dict, fetch_list, target_list,
-> 1407         run_metadata)
   1408 
   1409   def _call_tf_sessionprun(self, handle, feed_dict, fetch_list):

KeyboardInterrupt: 

?
#
# 안뇽 
?
?
